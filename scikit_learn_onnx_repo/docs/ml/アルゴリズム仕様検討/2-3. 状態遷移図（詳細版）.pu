@startuml
[*] --> COLD_START

COLD_START --> NORMAL : データ量が閾値以上

' NORMAL のループ
NORMAL --> NORMAL : 朝一バッチ/車両起動\n=> 通常リコメンド再評価

' イレギュラー
NORMAL --> EMERGENCY_BEFORE_NORMAL : SOCが予測より早く閾値以下に近づく
NORMAL --> OPPORTUNISTIC_CHARGE : 通常習慣外タイミングで\n充電開始イベント
NORMAL --> TRAVEL : 長距離/未知クラスタ滞在が連続

EMERGENCY_BEFORE_NORMAL --> NORMAL : 緊急充電完了 & 走行パターンが平常
EMERGENCY_BEFORE_NORMAL --> TRAVEL : 旅行が継続

OPPORTUNISTIC_CHARGE --> NORMAL : 充電完了 & 平常パターン
OPPORTUNISTIC_CHARGE --> TRAVEL : 旅行等の継続

TRAVEL --> NORMAL : 一定期間、平常クラスタ/距離に戻る

@enduml
